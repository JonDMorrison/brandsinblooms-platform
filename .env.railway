# Railway Environment Variables Template
# Copy these to Railway's environment variables dashboard
# Railway automatically injects: PORT, RAILWAY_PUBLIC_DOMAIN, RAILWAY_STATIC_URL

# =============================================================================
# CRITICAL PRODUCTION VARIABLES (Required)
# =============================================================================

# Supabase Configuration
NEXT_PUBLIC_SUPABASE_URL=                    # Your Supabase project URL
NEXT_PUBLIC_SUPABASE_ANON_KEY=               # Supabase anonymous key
SUPABASE_SERVICE_ROLE_KEY=                   # Supabase service role key (keep secret!)

# Domain Configuration
NEXT_PUBLIC_APP_DOMAIN=blooms.cc             # Your primary domain
NEXT_PUBLIC_SUBDOMAIN_SUFFIX=.blooms.cc      # Subdomain suffix for multi-tenant sites

# =============================================================================
# CACHING STRATEGY (Railway Redis Add-on)
# =============================================================================

# Redis Configuration (use Railway's Redis add-on)
REDIS_URL=${{REDIS_URL}}                     # Auto-populated by Railway Redis add-on
REDIS_MAX_RETRIES=3
REDIS_RETRY_DELAY=1000
REDIS_KEY_PREFIX=site:
REDIS_FALLBACK_MEMORY=true
SITE_CACHE_TTL=300                           # 5 minutes
API_CACHE_TTL=60                             # 1 minute
STATIC_CACHE_TTL=86400                       # 24 hours

# =============================================================================
# PERFORMANCE OPTIMIZATION
# =============================================================================

# Connection Pooling
DB_POOL_MIN=2
DB_POOL_MAX=10
DB_STATEMENT_TIMEOUT=30000                   # 30 seconds

# Next.js Optimization
NEXT_SHARP_PATH=/tmp/node_modules/sharp      # Optimize image processing in serverless
NEXT_TELEMETRY_DISABLED=1

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# CSRF Protection
CSRF_PROTECTION=true
CSRF_SECRET_KEY=${{CSRF_SECRET_KEY}}         # Generate with: openssl rand -base64 32

# Security Headers
SECURE_COOKIES=true
FORCE_HTTPS=true
SECURITY_ENABLED=true

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_WINDOW_MS=60000

# CORS Configuration
CORS_ENABLED=true
CORS_ALLOWED_ORIGINS=https://blooms.cc,https://*.blooms.cc,${{RAILWAY_PUBLIC_DOMAIN}}
CORS_ALLOW_CREDENTIALS=true

# =============================================================================
# MONITORING & ANALYTICS
# =============================================================================

# Analytics
ANALYTICS_ENABLED=true
ANALYTICS_STORAGE_TYPE=database
ANALYTICS_MAX_EVENTS=50000

# Error Tracking
ERROR_TRACKING_ENABLED=true
PERFORMANCE_MONITORING=true

# Logging
LOG_LEVEL=info                               # debug, info, warn, error
LOG_FORMAT=json                              # json for structured logging

# =============================================================================
# MULTI-DOMAIN SUPPORT
# =============================================================================

# Domain Verification
DOMAIN_VERIFICATION_ENABLED=true
DOMAIN_VERIFICATION_TTL=300
DOMAIN_VERIFICATION_DNS_TIMEOUT=5000

# SSL Configuration
SSL_MODE=flexible                            # flexible, full, strict
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true

# =============================================================================
# RAILWAY-SPECIFIC OPTIMIZATIONS
# =============================================================================

# Build Cache
RAILWAY_BUILD_CACHE=true
RAILWAY_DOCKERFILE_CACHE=true

# Deployment Region
RAILWAY_REGION=us-west1                      # us-west1, us-east4, europe-west4

# Resource Limits (Railway Pro)
RAILWAY_MEMORY_LIMIT=512                     # MB
RAILWAY_CPU_LIMIT=0.5                        # vCPUs

# =============================================================================
# BACKUP & RECOVERY
# =============================================================================

# Backup Configuration
BACKUP_ENABLED=false                         # Enable if using external backup service
BACKUP_RETENTION_DAYS=30

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Feature Toggles
ENABLE_REDIS_CACHE=true
ENABLE_EDGE_CACHING=true
ENABLE_IMAGE_OPTIMIZATION=true
ENABLE_BUNDLE_ANALYZER=false

# =============================================================================
# NOTES FOR RAILWAY DEPLOYMENT
# =============================================================================
# 1. Add Redis add-on: railway add redis
# 2. Set up custom domains in Railway dashboard
# 3. Configure wildcard DNS: *.blooms.cc -> Railway app
# 4. Enable SSL for custom domains
# 5. Set up health checks and monitoring
# 6. Configure auto-scaling if needed (Railway Pro)
# 7. Set up deployment webhooks for CI/CD